<div th:fragment="paymentsForm" th:if="${payment != null}">
    <div class="form-container" style="max-width: 400px;">
        <h2 class="mb-2 text-primary text-center"
            th:text="${payment.id} != null ? 'Edit Payment' : 'New Payment'"></h2>
        <form class="mt-2" onsubmit="submitForm(event, 'payments')" th:object="${payment}">
            <input th:field="*{id}" type="hidden"/>
            <div class="mb-2">
                <label class="form-label" for="reservation">Reservation</label>
                <select class="form-select" id="reservation" th:field="*{reservation.id}">
                    <option th:each="r : ${reservations}" th:selected="${payment.reservation != null and r.id == payment.reservation.id}"
                            th:text="${r.id + ' - ' + r.customer.firstName + ' ' + r.customer.lastName}"
                            th:value="${r.id}">
                    </option>
                </select>
            </div>
            <div class="mb-2">
                <label class="form-label" for="amount">Amount</label>
                <input class="form-control" id="amount" step="0.01" th:field="*{amount}" type="number"/>
            </div>
            <div class="mb-2">
                <label class="form-label" for="currency">Currency</label>
                <select class="form-select" id="currency" th:field="*{currency}">
                    <option th:selected="${payment.status == 'INR'}" value="INR">INR</option>
                    <option th:selected="${payment.status == 'USD'}" value="USD">USD</option>
                    <option th:selected="${payment.status == 'EUR'}" value="EUR">EUR</option>
                </select>
            </div>
            <div class="mb-2">
                <label class="form-label" for="method">Payment Method</label>
                <select class="form-select" id="method" th:field="*{method}">
                    <option th:selected="${payment.status == 'Credit Card'}" value="Credit Card">Credit Card</option>
                    <option th:selected="${payment.status == 'PayPal'}" value="PayPal">PayPal</option>
                    <option th:selected="${payment.status == 'UPI'}" value="UPI">UPI</option>
                    <option th:selected="${payment.status == 'Debit Card'}" value="Debit Card">Debit Card</option>
                    <option th:selected="${payment.status == 'Cash'}" value="Cash">Cash</option>
                </select>
            </div>
            <div class="mb-2">
                <label class="form-label" for="status">Status</label>
                <select class="form-select" id="status" th:field="*{status}">
                    <option th:selected="${payment.status == 'Pending'}" value="Pending">Pending</option>
                    <option th:selected="${payment.status == 'Completed'}" value="Completed">Completed</option>
                    <option th:selected="${payment.status == 'Failed'}" value="Failed">Failed</option>
                </select>
            </div>
            <div class="mb-2">
                <label class="form-label visually-hidden" for="transactionId">Transaction ID</label>
                <input class="form-control" id="transactionId" th:field="*{transactionId}" type="hidden"/>
            </div>
            <div class="d-flex gap-2">
                <!-- Save / Update button -->
                <button class="btn btn-success" type="submit">
                    <i class="bi bi-save"></i>
                    <span th:text="${payment.id != null} ? 'Update' : 'Create'"></span>
                </button>
                <!-- Back button loads the list fragment -->
                <a class="btn btn-secondary" href="#" onclick="loadList('payments')">
                    <i class="bi bi-arrow-left-circle"></i>Back to Payments</a>
            </div>
        </form>
    </div>
</div>
